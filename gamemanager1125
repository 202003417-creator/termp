-- GameManager 클래스의 속성 선언 부분
Property {
    Entity uiSkillSelect = UI/SkillSelectUI/UISprite,   -- UI 엔티티 경로를 변수에 저장
    tableEntity skillBtn                                 -- 스킬 버튼 엔티티 테이블
}

-- 스킬 선택창 열기 함수
void OpenSkillSelect() {
    -- 스킬 선택 UI를 위로 애니메이션 이동
    _TweenLogic:MoveTo(self.uiSkillSelect, Vector2(0, -400), 0.3, EaseType.BounceEaseInOut)
    
    -- 1~9까지의 숫자 목록을 랜덤으로 3개 선택
    local data = {1, 2, 3, 4, 5, 6, 7, 8, 9}
    for i = 1, 3 do
        local number = math.random(#data)
        local skillId = data[number]
        table.remove(data, number)   -- 중복 방지로 선택된 숫자 제거

        -- 스킬 버튼에 아이콘, 이름, 설명 할당
        self.skillBtn[i].Children[1].SpriteGuiRendererComponent.ImageUID = SkillManager.allSkillData[skillId]["icon"]
        self.skillBtn[i].Children[2].TextComponent.Text = SkillManager.allSkillData[skillId]["name"]
        self.skillBtn[i].Children[3].TextComponent.Text = SkillManager.allSkillData[skillId]["description"]
    end
}

-- 스킬 선택창 닫기 함수(구현은 없음)
void CloseSkillSelect() {_TweenLogic:MoveTo(self.uiSkillSelect, Vector2(0,-700), 0.3,EaseType.BounceEaseInOut)}

-- 게임 시작 시 실행되는 초기화 함수 (클라이언트 전용)
void OnBeginPlay() {
    for i = 1, 3 do
        table.insert(self.skillBtn, self.uiSkillSelect.Children[i + 1])   -- 스킬 버튼을 테이블에 등록
    end
}

-- 키 입력 이벤트 핸들러
service on InputService
HandleKeyDownEvent(KeyDownEvent event) {
    local key = event.key      -- 입력된 키 정보 획득
    if key == KeyboardKey.Alpha1 then   -- 1번 키 누르면 스킬 선택창 열기
        self.OpenSkillSelect()
    end
    if    key == KeyboardKey.Alpha2 then   -- 2번 키: 스킬 선택창 닫기
        self.CloseSkillSelect()
    end
}
