public class MaplePortalController
{
    public PortalComponent portalComponent;       // 포탈 정보
    public MovementComponent movementComponent;   // 플레이어 이동 컴포넌트
    public TransformComponent playerTransform;    // 플레이어 위치 정보
    public Entity playerEntity;                   // 플레이어 엔티티

    void Update()
    {
        // 플레이어가 포탈 영역 안에 있고, ↑ 키를 누른 경우
        if (IsPlayerInPortalArea() && Input.GetKeyDown(KeyCode.UpArrow))
        {
            MoveToMap2();
        }
    }

    bool IsPlayerInPortalArea()
    {
        // 포탈 위치, 크기 기준으로 플레이어 위치를 감지 
        Vector2 playerPos = new Vector2(playerTransform.Position.x, playerTransform.Position.y);
        Vector2 portalPos = new Vector2(portalComponent.Entity.Position.x, portalComponent.Entity.Position.y);

        Vector2 min = portalPos + portalComponent.BoxOffset - (portalComponent.BoxSize / 2);
        Vector2 max = portalPos + portalComponent.BoxOffset + (portalComponent.BoxSize / 2);

        return (playerPos.x >= min.x && playerPos.x <= max.x) && (playerPos.y >= min.y && playerPos.y <= max.y);
    }

    void MoveToMap2()
    {
        
        Entity map2Entity = portalComponent.PortalEntityRef;  //map2로 이동
        if (map2Entity != null)
        {
            TransformComponent map2Transform = map2Entity.GetComponent<TransformComponent>();
            if (map2Transform != null)
            {
                movementComponent.SetPosition(map2Transform.Position);      // 플레이어 위치 이동
                portalComponent.PortalUseEvent(playerEntity);               // 포탈 사용 이벤트 호출
            }
        }
    }
}
